<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>libvirt-domain-snapshot: APIs for management of domain snapshots</title>
    <meta name="generator" content="Libvirt devhelp stylesheet"/>
    <link rel="start" href="index.html" title="libvirt Reference Manual"/>
    <link rel="up" href="general.html" title="API"/>
    <link rel="stylesheet" href="style.css" type="text/css"/>
    <link rel="chapter" href="general.html" title="API"/>
  </head>
  <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
    <table class="navigation" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
      <tr valign="middle">
        <td>
          <a accesskey="p" href="libvirt-libvirt-domain-checkpoint.html">
            <img src="left.png" width="24" height="24" border="0" alt="Prev"/>
          </a>
        </td>
        <td>
          <a accesskey="u" href="general.html">
            <img src="up.png" width="24" height="24" border="0" alt="Up"/>
          </a>
        </td>
        <td>
          <a accesskey="h" href="index.html">
            <img src="home.png" width="24" height="24" border="0" alt="Home"/>
          </a>
        </td>
        <td>
          <a accesskey="n" href="libvirt-libvirt-domain.html">
            <img src="right.png" width="24" height="24" border="0" alt="Next"/>
          </a>
        </td>
        <th width="100%" align="center">libvirt Reference Manual</th>
      </tr>
    </table>
    <h2>
      <span class="refentrytitle">libvirt-domain-snapshot</span>
    </h2>
    <p>libvirt-domain-snapshot - APIs for management of domain snapshots</p>
    <p>Provides APIs for the management of domain snapshots  Copyright (C) 2006-2014 Red Hat, Inc.  This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation; either version 2.1 of the License, or (at your option) any later version.  This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more details.  You should have received a copy of the GNU Lesser General Public License along with this library.  If not, see &lt;http://www.gnu.org/licenses/&gt;. </p>
    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>
      <pre class="synopsis">typedef struct _virDomainSnapshot <a href="#virDomainSnapshot">virDomainSnapshot</a>;
typedef enum <a href="#virDomainSnapshotCreateFlags">virDomainSnapshotCreateFlags</a>;
typedef enum <a href="#virDomainSnapshotDeleteFlags">virDomainSnapshotDeleteFlags</a>;
typedef enum <a href="#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a>;
typedef <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshot">virDomainSnapshot</a> * <a href="#virDomainSnapshotPtr">virDomainSnapshotPtr</a>;
typedef enum <a href="#virDomainSnapshotRevertFlags">virDomainSnapshotRevertFlags</a>;
typedef enum <a href="#virDomainSnapshotXMLFlags">virDomainSnapshotXMLFlags</a>;
int	<a href="#virDomainHasCurrentSnapshot">virDomainHasCurrentSnapshot</a>	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 unsigned int flags);
int	<a href="#virDomainListAllSnapshots">virDomainListAllSnapshots</a>	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> ** snaps, <br/>					 unsigned int flags);
int	<a href="#virDomainRevertToSnapshot">virDomainRevertToSnapshot</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags);
<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	<a href="#virDomainSnapshotCreateXML">virDomainSnapshotCreateXML</a>	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>							 const char * xmlDesc, <br/>							 unsigned int flags);
<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	<a href="#virDomainSnapshotCurrent">virDomainSnapshotCurrent</a>	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>							 unsigned int flags);
int	<a href="#virDomainSnapshotDelete">virDomainSnapshotDelete</a>		(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags);
int	<a href="#virDomainSnapshotFree">virDomainSnapshotFree</a>		(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot);
<a href="libvirt-libvirt-host.html#virConnectPtr">virConnectPtr</a>	<a href="#virDomainSnapshotGetConnect">virDomainSnapshotGetConnect</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot);
<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a>	<a href="#virDomainSnapshotGetDomain">virDomainSnapshotGetDomain</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot);
const char *	<a href="#virDomainSnapshotGetName">virDomainSnapshotGetName</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot);
<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	<a href="#virDomainSnapshotGetParent">virDomainSnapshotGetParent</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>							 unsigned int flags);
char *	<a href="#virDomainSnapshotGetXMLDesc">virDomainSnapshotGetXMLDesc</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags);
int	<a href="#virDomainSnapshotHasMetadata">virDomainSnapshotHasMetadata</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags);
int	<a href="#virDomainSnapshotIsCurrent">virDomainSnapshotIsCurrent</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags);
int	<a href="#virDomainSnapshotListAllChildren">virDomainSnapshotListAllChildren</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>						 <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> ** snaps, <br/>						 unsigned int flags);
int	<a href="#virDomainSnapshotListChildrenNames">virDomainSnapshotListChildrenNames</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>						 char ** names, <br/>						 int nameslen, <br/>						 unsigned int flags);
int	<a href="#virDomainSnapshotListNames">virDomainSnapshotListNames</a>	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 char ** names, <br/>					 int nameslen, <br/>					 unsigned int flags);
<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	<a href="#virDomainSnapshotLookupByName">virDomainSnapshotLookupByName</a>	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>							 const char * name, <br/>							 unsigned int flags);
int	<a href="#virDomainSnapshotNum">virDomainSnapshotNum</a>		(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 unsigned int flags);
int	<a href="#virDomainSnapshotNumChildren">virDomainSnapshotNumChildren</a>	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags);
int	<a href="#virDomainSnapshotRef">virDomainSnapshotRef</a>		(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot);
</pre>
    </div>
    <div class="refsect1" lang="en">
      <h2>Description</h2>
    </div>
    <div class="refsect1" lang="en">
      <h2>Details</h2>
      <div class="refsect2" lang="en">
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshot">Structure </a>virDomainSnapshot</h3><pre class="programlisting">struct _virDomainSnapshot {
The content of this structure is not made public by the API.
} virDomainSnapshot;
</pre><p/>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotCreateFlags">Enum </a>virDomainSnapshotCreateFlags</h3><pre class="programlisting">enum <a href="#virDomainSnapshotCreateFlags">virDomainSnapshotCreateFlags</a> {
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_REDEFINE">VIR_DOMAIN_SNAPSHOT_CREATE_REDEFINE</a> = 1 /* Restore or alter metadata */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_CURRENT">VIR_DOMAIN_SNAPSHOT_CREATE_CURRENT</a> = 2 /* With redefine, make snapshot current */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_NO_METADATA">VIR_DOMAIN_SNAPSHOT_CREATE_NO_METADATA</a> = 4 /* Make snapshot without remembering it */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_HALT">VIR_DOMAIN_SNAPSHOT_CREATE_HALT</a> = 8 /* Stop running guest after snapshot */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_DISK_ONLY">VIR_DOMAIN_SNAPSHOT_CREATE_DISK_ONLY</a> = 16 /* disk snapshot, not full system */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_REUSE_EXT">VIR_DOMAIN_SNAPSHOT_CREATE_REUSE_EXT</a> = 32 /* reuse any existing external files */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_QUIESCE">VIR_DOMAIN_SNAPSHOT_CREATE_QUIESCE</a> = 64 /* use guest agent to quiesce all mounted file systems within the domain */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_ATOMIC">VIR_DOMAIN_SNAPSHOT_CREATE_ATOMIC</a> = 128 /* atomically avoid partial changes */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_LIVE">VIR_DOMAIN_SNAPSHOT_CREATE_LIVE</a> = 256 /* create the snapshot while the guest is running */
    <a name="VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE">VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE</a> = 512 /* validate the XML against the schema */
};
</pre><p/>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotDeleteFlags">Enum </a>virDomainSnapshotDeleteFlags</h3><pre class="programlisting">enum <a href="#virDomainSnapshotDeleteFlags">virDomainSnapshotDeleteFlags</a> {
    <a name="VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN">VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN</a> = 1 /* Also delete children */
    <a name="VIR_DOMAIN_SNAPSHOT_DELETE_METADATA_ONLY">VIR_DOMAIN_SNAPSHOT_DELETE_METADATA_ONLY</a> = 2 /* Delete just metadata */
    <a name="VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN_ONLY">VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN_ONLY</a> = 4 /* Delete just children */
};
</pre><p/>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotListFlags">Enum </a>virDomainSnapshotListFlags</h3><pre class="programlisting">enum <a href="#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a> {
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS">VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS</a> = 1 /* List all descendants, not just children, when listing a snapshot For historical reasons, groups do not use contiguous bits. */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_ROOTS">VIR_DOMAIN_SNAPSHOT_LIST_ROOTS</a> = 1 /* Filter by snapshots with no parents, when listing a domain */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_METADATA">VIR_DOMAIN_SNAPSHOT_LIST_METADATA</a> = 2 /* Filter by snapshots which have metadata */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_LEAVES">VIR_DOMAIN_SNAPSHOT_LIST_LEAVES</a> = 4 /* Filter by snapshots with no children */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES">VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES</a> = 8 /* Filter by snapshots that have children */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA">VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA</a> = 16 /* Filter by snapshots with no metadata */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_INACTIVE">VIR_DOMAIN_SNAPSHOT_LIST_INACTIVE</a> = 32 /* Filter by snapshots taken while guest was shut off */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_ACTIVE">VIR_DOMAIN_SNAPSHOT_LIST_ACTIVE</a> = 64 /* Filter by snapshots taken while guest was active, and with memory state */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_DISK_ONLY">VIR_DOMAIN_SNAPSHOT_LIST_DISK_ONLY</a> = 128 /* Filter by snapshots taken while guest was active, but without memory state */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_INTERNAL">VIR_DOMAIN_SNAPSHOT_LIST_INTERNAL</a> = 256 /* Filter by snapshots stored internal to disk images */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_EXTERNAL">VIR_DOMAIN_SNAPSHOT_LIST_EXTERNAL</a> = 512 /* Filter by snapshots that use files external to disk images */
    <a name="VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL">VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL</a> = 1024 /* Ensure parents occur before children in the resulting list */
};
</pre><p/>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotPtr">Typedef </a>virDomainSnapshotPtr</h3><pre class="programlisting"><a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshot">virDomainSnapshot</a> * virDomainSnapshotPtr;
</pre><p>A <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> is pointer to a <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshot">virDomainSnapshot</a> private structure, and is the type used to reference a domain snapshot in the API.</p>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotRevertFlags">Enum </a>virDomainSnapshotRevertFlags</h3><pre class="programlisting">enum <a href="#virDomainSnapshotRevertFlags">virDomainSnapshotRevertFlags</a> {
    <a name="VIR_DOMAIN_SNAPSHOT_REVERT_RUNNING">VIR_DOMAIN_SNAPSHOT_REVERT_RUNNING</a> = 1 /* Run after revert */
    <a name="VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED">VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED</a> = 2 /* Pause after revert */
    <a name="VIR_DOMAIN_SNAPSHOT_REVERT_FORCE">VIR_DOMAIN_SNAPSHOT_REVERT_FORCE</a> = 4 /* Allow risky reverts */
};
</pre><p/>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotXMLFlags">Enum </a>virDomainSnapshotXMLFlags</h3><pre class="programlisting">enum <a href="#virDomainSnapshotXMLFlags">virDomainSnapshotXMLFlags</a> {
    <a name="VIR_DOMAIN_SNAPSHOT_XML_SECURE">VIR_DOMAIN_SNAPSHOT_XML_SECURE</a> = VIR_DOMAIN_XML_SECURE /* dump security sensitive information too */
};
</pre><p/>
</div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainHasCurrentSnapshot"/>virDomainHasCurrentSnapshot ()</h3><pre class="programlisting">int	virDomainHasCurrentSnapshot	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 unsigned int flags)<br/>
</pre><p>Determine if the domain has a current snapshot.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>pointer to the domain object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>extra flags; not used yet, so callers should always pass 0</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>1 if such snapshot exists, 0 if it doesn't, -1 on error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainListAllSnapshots"/>virDomainListAllSnapshots ()</h3><pre class="programlisting">int	virDomainListAllSnapshots	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> ** snaps, <br/>					 unsigned int flags)<br/>
</pre><p>Collect the list of domain snapshots for the given domain and allocate
an array to store those objects. This API solves the race inherent in
virDomainSnapshotListNames().

If @flags contains <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL">VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL</a> and @snaps
is non-NULL, and no other connection is modifying snapshots, then
it is guaranteed that for any snapshot in the resulting list, no
snapshots later in the list can be reached by a sequence of
virDomainSnapshotGetParent() starting from that earlier snapshot;
otherwise, the order of snapshots in the resulting list is
unspecified.

By default, this command covers all snapshots. It is also possible
to limit things to just snapshots with no parents, when @flags
includes VIR_DOMAIN_SNAPSHOT_LIST_ROOTS. Additional filters are
provided in groups listed below. Within a group, bits are mutually
exclusive, where all possible snapshots are described by exactly
one bit from the group. Some hypervisors might reject particular
flags where it cannot make a distinction for filtering. If the set
of filter flags selected forms an impossible combination, the
hypervisor may return either 0 or an error.

The first group of @flags is <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_LEAVES">VIR_DOMAIN_SNAPSHOT_LIST_LEAVES</a> and
VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES, to filter based on snapshots that
have no further children (a leaf snapshot).

The next group of @flags is <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_METADATA">VIR_DOMAIN_SNAPSHOT_LIST_METADATA</a> and
VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA, for filtering snapshots based on
whether they have metadata that would prevent the removal of the last
reference to a domain.

The next group of @flags is VIR_DOMAIN_SNAPSHOT_LIST_INACTIVE,
VIR_DOMAIN_SNAPSHOT_LIST_ACTIVE, and VIR_DOMAIN_SNAPSHOT_LIST_DISK_ONLY,
for filtering snapshots based on what domain state is tracked by the
snapshot.

The next group of @flags is <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_INTERNAL">VIR_DOMAIN_SNAPSHOT_LIST_INTERNAL</a> and
VIR_DOMAIN_SNAPSHOT_LIST_EXTERNAL, for filtering snapshots based on
whether the snapshot is stored inside the disk images or as
additional files.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>a domain object</td></tr><tr><td><span class="term"><i><tt>snaps</tt></i>:</span></td><td>pointer to variable to store the array containing snapshot objects or NULL if the list is not required (just returns number of snapshots)</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the number of domain snapshots found or -1 and sets @snaps to NULL in case of error. On success, the array stored into @snaps is guaranteed to have an extra allocated element set to NULL but not included in the return count, to make iteration easier. The caller is responsible for calling virDomainSnapshotFree() on each array element, then calling free() on @snaps.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainRevertToSnapshot"/>virDomainRevertToSnapshot ()</h3><pre class="programlisting">int	virDomainRevertToSnapshot	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags)<br/>
</pre><p>Revert the domain to a given snapshot.

Normally, the domain will revert to the same state the domain was
in while the snapshot was taken (whether inactive, running, or
paused), except that disk snapshots default to reverting to
inactive state. Including <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_REVERT_RUNNING">VIR_DOMAIN_SNAPSHOT_REVERT_RUNNING</a> in
@flags overrides the snapshot state to guarantee a running domain
after the revert; or including <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED">VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED</a> in
@flags guarantees a paused domain after the revert. These two
flags are mutually exclusive. While a persistent domain does not
need either flag, it is not possible to revert a transient domain
into an inactive state, so transient domains require the use of one
of these two flags.

Reverting to any snapshot discards all configuration changes made since
the last snapshot. Additionally, reverting to a snapshot from a running
domain is a form of data loss, since it discards whatever is in the
guest's RAM at the time. Since the very nature of keeping snapshots
implies the intent to roll back state, no additional confirmation is
normally required for these lossy effects.

However, there are two particular situations where reverting will
be refused by default, and where @flags must include
VIR_DOMAIN_SNAPSHOT_REVERT_FORCE to acknowledge the risks. 1) Any
attempt to revert to a snapshot that lacks the metadata to perform
ABI compatibility checks (generally the case for snapshots that
lack a full &lt;domain&gt; when listed by virDomainSnapshotGetXMLDesc(),
such as those created prior to libvirt 0.9.5). 2) Any attempt to
revert a running domain to an active state that requires starting a
new hypervisor instance rather than reusing the existing hypervisor
(since this would terminate all connections to the domain, such as
such as VNC or Spice graphics) - this condition arises from active
snapshots that are provably ABI incompatible, as well as from
inactive snapshots with a @flags request to start the domain after
the revert.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotRevertFlags">virDomainSnapshotRevertFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>0 if the creation is successful, -1 on error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotCreateXML"/>virDomainSnapshotCreateXML ()</h3><pre class="programlisting"><a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	virDomainSnapshotCreateXML	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>							 const char * xmlDesc, <br/>							 unsigned int flags)<br/>
</pre><p>Creates a new snapshot of a domain based on the snapshot xml
contained in xmlDesc, with a top-level element &lt;domainsnapshot&gt;.

If @flags is 0, the domain can be active, in which case the
snapshot will be a full system snapshot (capturing both disk state,
and runtime VM state such as RAM contents), where reverting to the
snapshot is
the same as resuming from hibernation (TCP connections may have
timed out, but everything else picks up where it left off); or
the domain can be inactive, in which case the snapshot includes
just the disk state prior to booting. The newly created snapshot
becomes current (see virDomainSnapshotCurrent()), and is a child
of any previous current snapshot.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE, then @xmlDesc
is validated against the &lt;domainsnapshot&gt; XML schema.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_REDEFINE, then this
is a request to reinstate snapshot metadata that was previously
captured from virDomainSnapshotGetXMLDesc() before removing that
metadata, rather than creating a new snapshot. This can be used to
recreate a snapshot hierarchy on a destination, then remove it on
the source, in order to allow migration (since migration normally
fails if snapshot metadata still remains on the source machine).
Note that while original creation can omit a number of elements
from @xmlDesc (and libvirt will supply sane defaults based on the
domain state at that point in time), a redefinition must supply
more elements (as the domain may have changed in the meantime, so
that libvirt no longer has a way to resupply correct
defaults). When redefining snapshot metadata, the domain's current
snapshot will not be altered unless the
VIR_DOMAIN_SNAPSHOT_CREATE_CURRENT flag is also present. It is an
error to request the <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_CREATE_CURRENT">VIR_DOMAIN_SNAPSHOT_CREATE_CURRENT</a> flag
without VIR_DOMAIN_SNAPSHOT_CREATE_REDEFINE. On some hypervisors,
redefining an existing snapshot can be used to alter host-specific
portions of the domain XML to be used during revert (such as
backing filenames associated with disk devices), but must not alter
guest-visible layout. When redefining a snapshot name that does
not exist, the hypervisor may validate that reverting to the
snapshot appears to be possible (for example, disk images have
snapshot contents by the requested name). Not all hypervisors
support these flags.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_NO_METADATA, then the
domain's disk images are modified according to @xmlDesc, but
libvirt does not track any metadata (similar to immediately calling
virDomainSnapshotDelete() with
VIR_DOMAIN_SNAPSHOT_DELETE_METADATA_ONLY). This flag is
incompatible with VIR_DOMAIN_SNAPSHOT_CREATE_REDEFINE.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_HALT, then the domain
will be inactive after the snapshot completes, regardless of whether
it was active before; otherwise, a running domain will still be
running after the snapshot. This flag is invalid on transient domains,
and is incompatible with VIR_DOMAIN_SNAPSHOT_CREATE_REDEFINE.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_LIVE, then the domain
is not paused while creating the snapshot. This increases the size
of the memory dump file, but reduces downtime of the guest while
taking the snapshot. Some hypervisors only support this flag during
external snapshots.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_DISK_ONLY, then the
snapshot will be limited to the disks described in @xmlDesc, and no
VM state will be saved. For an active guest, the disk image may be
inconsistent (as if power had been pulled), and specifying this
with the <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_CREATE_HALT">VIR_DOMAIN_SNAPSHOT_CREATE_HALT</a> flag risks data loss.

If @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_QUIESCE, then the
libvirt will attempt to use guest agent to freeze and thaw all
file systems in use within domain OS. However, if the guest agent
is not present, an error is thrown. Moreover, this flag requires
VIR_DOMAIN_SNAPSHOT_CREATE_DISK_ONLY to be passed as well.

By default, if the snapshot involves external files, and any of the
destination files already exist as a non-empty regular file, the
snapshot is rejected to avoid losing contents of those files.
However, if @flags includes VIR_DOMAIN_SNAPSHOT_CREATE_REUSE_EXT,
then the destination files must be pre-created manually with
the correct image format and metadata including backing store path
(this allows a management app to pre-create files with relative backing
file names, rather than the default of creating with absolute backing
file names). Note that only the file specified in the snapshot XML is
inserted as a snapshot thus setting incorrect metadata in the pre-created
image may lead to the VM being unable to start or other block jobs may fail.

Be aware that although libvirt prefers to report errors up front with
no other effect, some hypervisors have certain types of failures where
the overall command can easily fail even though the guest configuration
was partially altered (for example, if a disk snapshot request for two
disks fails on the second disk, but the first disk alteration cannot be
rolled back). If this API call fails, it is therefore normally
necessary to follow up with virDomainGetXMLDesc() and check each disk
to determine if any partial changes occurred. However, if @flags
contains VIR_DOMAIN_SNAPSHOT_CREATE_ATOMIC, then libvirt guarantees
that this command will not alter any disks unless the entire set of
changes can be done atomically, making failure recovery simpler (note
that it is still possible to fail after disks have changed, but only
in the much rarer cases of running out of memory or disk space).

Some hypervisors may prevent this operation if there is a current
block copy operation; in that case, use virDomainBlockJobAbort()
to stop the block copy first.

virDomainSnapshotFree should be used to free the resources after the
snapshot object is no longer needed.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>a domain object</td></tr><tr><td><span class="term"><i><tt>xmlDesc</tt></i>:</span></td><td>string containing an XML description of the domain snapshot</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotCreateFlags">virDomainSnapshotCreateFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>an (opaque) new <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> on success or NULL on failure.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotCurrent"/>virDomainSnapshotCurrent ()</h3><pre class="programlisting"><a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	virDomainSnapshotCurrent	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>							 unsigned int flags)<br/>
</pre><p>Get the current snapshot for a domain, if any.

virDomainSnapshotFree should be used to free the resources after the
snapshot object is no longer needed.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>a domain object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>extra flags; not used yet, so callers should always pass 0</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>a domain snapshot object or NULL in case of failure. If the current domain snapshot cannot be found, then the <a href="libvirt-virterror.html#VIR_ERR_NO_DOMAIN_SNAPSHOT">VIR_ERR_NO_DOMAIN_SNAPSHOT</a> error is raised.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotDelete"/>virDomainSnapshotDelete ()</h3><pre class="programlisting">int	virDomainSnapshotDelete		(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags)<br/>
</pre><p>Delete the snapshot.

If @flags is 0, then just this snapshot is deleted, and changes
from this snapshot are automatically merged into children
snapshots. If @flags includes VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN,
then this snapshot and any descendant snapshots are deleted. If
@flags includes VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN_ONLY, then any
descendant snapshots are deleted, but this snapshot remains. These
two flags are mutually exclusive.

If @flags includes VIR_DOMAIN_SNAPSHOT_DELETE_METADATA_ONLY, then
any snapshot metadata tracked by libvirt is removed while keeping
the snapshot contents intact; if a hypervisor does not require any
libvirt metadata to track snapshots, then this flag is silently
ignored.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotDeleteFlags">virDomainSnapshotDeleteFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>0 if the selected snapshot(s) were successfully deleted, -1 on error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotFree"/>virDomainSnapshotFree ()</h3><pre class="programlisting">int	virDomainSnapshotFree		(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot)<br/>
</pre><p>Free the domain snapshot object. The snapshot itself is not modified.
The data structure is freed and should not be used thereafter.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>0 in case of success and -1 in case of failure.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotGetConnect"/>virDomainSnapshotGetConnect ()</h3><pre class="programlisting"><a href="libvirt-libvirt-host.html#virConnectPtr">virConnectPtr</a>	virDomainSnapshotGetConnect	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot)<br/>
</pre><p>Provides the connection pointer associated with a snapshot. The
reference counter on the connection is not increased by this
call.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a snapshot object</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the connection or NULL.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotGetDomain"/>virDomainSnapshotGetDomain ()</h3><pre class="programlisting"><a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a>	virDomainSnapshotGetDomain	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot)<br/>
</pre><p>Provides the domain pointer associated with a snapshot. The
reference counter on the domain is not increased by this
call.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a snapshot object</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the domain or NULL.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotGetName"/>virDomainSnapshotGetName ()</h3><pre class="programlisting">const char *	virDomainSnapshotGetName	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot)<br/>
</pre><p>Get the public name for that snapshot</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a snapshot object</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>a pointer to the name or NULL, the string need not be deallocated as its lifetime will be the same as the snapshot object.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotGetParent"/>virDomainSnapshotGetParent ()</h3><pre class="programlisting"><a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	virDomainSnapshotGetParent	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>							 unsigned int flags)<br/>
</pre><p>Get the parent snapshot for @snapshot, if any.

virDomainSnapshotFree should be used to free the resources after the
snapshot object is no longer needed.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>extra flags; not used yet, so callers should always pass 0</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>a domain snapshot object or NULL in case of failure. If the given snapshot is a root (no parent), then the <a href="libvirt-virterror.html#VIR_ERR_NO_DOMAIN_SNAPSHOT">VIR_ERR_NO_DOMAIN_SNAPSHOT</a> error is raised.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotGetXMLDesc"/>virDomainSnapshotGetXMLDesc ()</h3><pre class="programlisting">char *	virDomainSnapshotGetXMLDesc	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags)<br/>
</pre><p>Provide an XML description of the domain snapshot, with a top-level
element of &lt;domainsnapshot&gt;.

No security-sensitive data will be included unless @flags contains
VIR_DOMAIN_SNAPSHOT_XML_SECURE; this flag is rejected on read-only
connections.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotXMLFlags">virDomainSnapshotXMLFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>a 0 terminated UTF-8 encoded XML instance or NULL in case of error. The caller must free() the returned value.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotHasMetadata"/>virDomainSnapshotHasMetadata ()</h3><pre class="programlisting">int	virDomainSnapshotHasMetadata	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags)<br/>
</pre><p>Determine if the given snapshot is associated with libvirt metadata
that would prevent the deletion of the domain.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>extra flags; not used yet, so callers should always pass 0</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>1 if the snapshot has metadata, 0 if the snapshot exists without help from libvirt, or -1 on error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotIsCurrent"/>virDomainSnapshotIsCurrent ()</h3><pre class="programlisting">int	virDomainSnapshotIsCurrent	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags)<br/>
</pre><p>Determine if the given snapshot is the domain's current snapshot. See
also virDomainHasCurrentSnapshot().</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>extra flags; not used yet, so callers should always pass 0</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>1 if current, 0 if not current, or -1 on error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotListAllChildren"/>virDomainSnapshotListAllChildren ()</h3><pre class="programlisting">int	virDomainSnapshotListAllChildren	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>						 <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> ** snaps, <br/>						 unsigned int flags)<br/>
</pre><p>Collect the list of domain snapshots that are children of the given
snapshot, and allocate an array to store those objects. This API solves
the race inherent in virDomainSnapshotListChildrenNames().

If @flags lacks <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS">VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS</a> or contains
VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL, @snaps is non-NULL, and no
other connection is modifying snapshots, then it is guaranteed that
for any snapshot in the resulting list, no snapshots later in the
list can be reached by a sequence of virDomainSnapshotGetParent()
starting from that earlier snapshot; otherwise, the order of
snapshots in the resulting list is unspecified.

By default, this command covers only direct children. It is also
possible to expand things to cover all descendants, when @flags
includes VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS. Additional filters
are provided via the remaining @flags values as documented in
virDomainListAllSnapshots(), with the exception that
VIR_DOMAIN_SNAPSHOT_LIST_ROOTS is not supported (in fact,
VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS has the same bit value but
opposite semantics of widening rather than narrowing the listing).</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>snaps</tt></i>:</span></td><td>pointer to variable to store the array containing snapshot objects or NULL if the list is not required (just returns number of snapshots)</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the number of domain snapshots found or -1 and sets @snaps to NULL in case of error. On success, the array stored into @snaps is guaranteed to have an extra allocated element set to NULL but not included in the return count, to make iteration easier. The caller is responsible for calling virDomainSnapshotFree() on each array element, then calling free() on @snaps.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotListChildrenNames"/>virDomainSnapshotListChildrenNames ()</h3><pre class="programlisting">int	virDomainSnapshotListChildrenNames	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>						 char ** names, <br/>						 int nameslen, <br/>						 unsigned int flags)<br/>
</pre><p>Collect the list of domain snapshots that are children of the given
snapshot, and store their names in @names. The value to use for
@nameslen can be determined by virDomainSnapshotNumChildren() with
the same @flags.

If @flags lacks <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS">VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS</a> or contains
VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL, and no other connection is
modifying snapshots, then it is guaranteed that for any snapshot in
the resulting list, no snapshots later in the list can be reached
by a sequence of virDomainSnapshotGetParent() starting from that
earlier snapshot; otherwise, the order of snapshots in the
resulting list is unspecified.

By default, this command covers only direct children. It is also
possible to expand things to cover all descendants, when @flags
includes VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS. Additional filters
are provided via the same @flags values as documented in
virDomainSnapshotListAllChildren().

Note that this command is inherently racy: another connection can
define a new snapshot between a call to virDomainSnapshotNumChildren()
and this call. You are only guaranteed that all currently defined
snapshots were listed if the return is less than @nameslen. Likewise,
you should be prepared for virDomainSnapshotLookupByName() to fail when
converting a name from this call into a snapshot object, if another
connection deletes the snapshot in the meantime. For more control over
the results, see virDomainSnapshotListAllChildren().</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>names</tt></i>:</span></td><td>array to collect the list of names of snapshots</td></tr><tr><td><span class="term"><i><tt>nameslen</tt></i>:</span></td><td>size of @names</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the number of domain snapshots found or -1 in case of error. The caller is responsible to call free() for each member of the array.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotListNames"/>virDomainSnapshotListNames ()</h3><pre class="programlisting">int	virDomainSnapshotListNames	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 char ** names, <br/>					 int nameslen, <br/>					 unsigned int flags)<br/>
</pre><p>Collect the list of domain snapshots for the given domain, and store
their names in @names. The value to use for @nameslen can be determined
by virDomainSnapshotNum() with the same @flags.

If @flags contains VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL, and no
other connection is modifying snapshots, then it is guaranteed that
for any snapshot in the resulting list, no snapshots later in the
list can be reached by a sequence of virDomainSnapshotGetParent()
starting from that earlier snapshot; otherwise, the order of
snapshots in the resulting list is unspecified.

By default, this command covers all snapshots. It is also possible
to limit things to just snapshots with no parents, when @flags
includes VIR_DOMAIN_SNAPSHOT_LIST_ROOTS. Additional filters are
provided via the same @flags values as documented in
virDomainListAllSnapshots().

Note that this command is inherently racy: another connection can
define a new snapshot between a call to virDomainSnapshotNum() and
this call. You are only guaranteed that all currently defined
snapshots were listed if the return is less than @nameslen. Likewise,
you should be prepared for virDomainSnapshotLookupByName() to fail when
converting a name from this call into a snapshot object, if another
connection deletes the snapshot in the meantime. For more control over
the results, see virDomainListAllSnapshots().</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>a domain object</td></tr><tr><td><span class="term"><i><tt>names</tt></i>:</span></td><td>array to collect the list of names of snapshots</td></tr><tr><td><span class="term"><i><tt>nameslen</tt></i>:</span></td><td>size of @names</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the number of domain snapshots found or -1 in case of error. The caller is responsible to call free() for each member of the array.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotLookupByName"/>virDomainSnapshotLookupByName ()</h3><pre class="programlisting"><a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a>	virDomainSnapshotLookupByName	(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>							 const char * name, <br/>							 unsigned int flags)<br/>
</pre><p>Try to lookup a domain snapshot based on its name.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>a domain object</td></tr><tr><td><span class="term"><i><tt>name</tt></i>:</span></td><td>name for the domain snapshot</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>extra flags; not used yet, so callers should always pass 0</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>a domain snapshot object or NULL in case of failure. If the domain snapshot cannot be found, then the <a href="libvirt-virterror.html#VIR_ERR_NO_DOMAIN_SNAPSHOT">VIR_ERR_NO_DOMAIN_SNAPSHOT</a> error is raised.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotNum"/>virDomainSnapshotNum ()</h3><pre class="programlisting">int	virDomainSnapshotNum		(<a href="libvirt-libvirt-domain.html#virDomainPtr">virDomainPtr</a> domain, <br/>					 unsigned int flags)<br/>
</pre><p>Provides the number of domain snapshots for this domain.

This function will accept <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL">VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL</a> in
@flags only if virDomainSnapshotListNames() can honor it, although
the flag has no other effect here.

By default, this command covers all snapshots. It is also possible
to limit things to just snapshots with no parents, when @flags
includes VIR_DOMAIN_SNAPSHOT_LIST_ROOTS. Additional filters are
provided via the same @flags values as documented in
virDomainListAllSnapshots().</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>domain</tt></i>:</span></td><td>a domain object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the number of domain snapshots found or -1 in case of error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotNumChildren"/>virDomainSnapshotNumChildren ()</h3><pre class="programlisting">int	virDomainSnapshotNumChildren	(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot, <br/>					 unsigned int flags)<br/>
</pre><p>Provides the number of child snapshots for this domain snapshot.

This function will accept <a href="libvirt-libvirt-domain-snapshot.html#VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL">VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL</a> in
@flags only if virDomainSnapshotListChildrenNames() can honor it,
although the flag has no other effect here.

By default, this command covers only direct children. It is also
possible to expand things to cover all descendants, when @flags
includes VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS. Additional filters
are provided via the same @flags values as documented in
virDomainSnapshotListAllChildren().</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>a domain snapshot object</td></tr><tr><td><span class="term"><i><tt>flags</tt></i>:</span></td><td>bitwise-OR of supported <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotListFlags">virDomainSnapshotListFlags</a></td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>the number of domain snapshots found or -1 in case of error.</td></tr></tbody></table></div></div>
        <hr/>
        <div class="refsect2" lang="en"><h3><a name="virDomainSnapshotRef"/>virDomainSnapshotRef ()</h3><pre class="programlisting">int	virDomainSnapshotRef		(<a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotPtr">virDomainSnapshotPtr</a> snapshot)<br/>
</pre><p>Increment the reference count on the snapshot. For each
additional call to this method, there shall be a corresponding
call to <a href="libvirt-libvirt-domain-snapshot.html#virDomainSnapshotFree">virDomainSnapshotFree</a> to release the reference count, once
the caller no longer needs the reference to this object.

This method is typically useful for applications where multiple
threads are using a connection, and it is required that the
connection and domain remain open until all threads have finished
using the snapshot. ie, each new thread using a snapshot would
increment the reference count.</p>
<div class="variablelist"><table border="0"><col align="left"/><tbody><tr><td><span class="term"><i><tt>snapshot</tt></i>:</span></td><td>the snapshot to hold a reference on</td></tr><tr><td><span class="term"><i><tt>Returns</tt></i>:</span></td><td>0 in case of success and -1 in case of failure.</td></tr></tbody></table></div></div>
        <hr/>
      </div>
    </div>
  </body>
</html>
